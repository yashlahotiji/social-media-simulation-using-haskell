<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{-|
Module      : Main
Description : Store Data in Multiple Threads, creation of a common box and 10 userlist.
License     : GPL-3
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Main</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Types.html"><span class="hs-identifier">Types</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">takeMVar</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Types.html"><span class="hs-identifier">Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Types.html#User"><span class="hs-identifier">User</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Types.html#messages"><span class="hs-identifier">messages</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span>  </span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SendMessage.html"><span class="hs-identifier">SendMessage</span></a></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- |Create 10 users and store them in an array and then create threads for each user and call SendMessage function from the SendMessage.hs file and stop the execution once we have an emtpy box.</span><span>
</span><span id="line-21"></span><span class="annot"><a href="Main.html#main"><span class="hs-identifier hs-type">main</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span id="main"><span class="annot"><span class="annottext">main :: IO ()
</span><a href="Main.html#main"><span class="hs-identifier hs-var hs-var">main</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-comment">-- msg'xx' is used for counting purpose</span><span>
</span><span id="line-24"></span><span>    </span><span id="local-6989586621679029700"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029700"><span class="hs-identifier hs-var">msg1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-25"></span><span>    </span><span id="local-6989586621679029698"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029698"><span class="hs-identifier hs-var">msg2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-26"></span><span>    </span><span id="local-6989586621679029697"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029697"><span class="hs-identifier hs-var">msg3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-27"></span><span>    </span><span id="local-6989586621679029696"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029696"><span class="hs-identifier hs-var">msg4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-28"></span><span>    </span><span id="local-6989586621679029695"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029695"><span class="hs-identifier hs-var">msg5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-29"></span><span>    </span><span id="local-6989586621679029694"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029694"><span class="hs-identifier hs-var">msg6</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-30"></span><span>    </span><span id="local-6989586621679029693"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029693"><span class="hs-identifier hs-var">msg7</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-31"></span><span>    </span><span id="local-6989586621679029692"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029692"><span class="hs-identifier hs-var">msg8</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-32"></span><span>    </span><span id="local-6989586621679029691"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029691"><span class="hs-identifier hs-var">msg9</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-33"></span><span>    </span><span id="local-6989586621679029690"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029690"><span class="hs-identifier hs-var">msg10</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-comment">--us'x' are the users along with their message and userlist stores all users name inside it.</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029689"><span class="annot"><span class="annottext">us1 :: User
</span><a href="#local-6989586621679029689"><span class="hs-identifier hs-var hs-var">us1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Yash&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029700"><span class="hs-identifier hs-var">msg1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Yash&quot;</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029687"><span class="annot"><span class="annottext">us2 :: User
</span><a href="#local-6989586621679029687"><span class="hs-identifier hs-var hs-var">us2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Khushi&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029698"><span class="hs-identifier hs-var">msg2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Khushi&quot;</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029686"><span class="annot"><span class="annottext">us3 :: User
</span><a href="#local-6989586621679029686"><span class="hs-identifier hs-var hs-var">us3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Mahek&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029697"><span class="hs-identifier hs-var">msg3</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Mahek&quot;</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029685"><span class="annot"><span class="annottext">us4 :: User
</span><a href="#local-6989586621679029685"><span class="hs-identifier hs-var hs-var">us4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Purvi&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029696"><span class="hs-identifier hs-var">msg4</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Purvi&quot;</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029684"><span class="annot"><span class="annottext">us5 :: User
</span><a href="#local-6989586621679029684"><span class="hs-identifier hs-var hs-var">us5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Anita&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029695"><span class="hs-identifier hs-var">msg5</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Anita&quot;</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029683"><span class="annot"><span class="annottext">us6 :: User
</span><a href="#local-6989586621679029683"><span class="hs-identifier hs-var hs-var">us6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Raj&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029694"><span class="hs-identifier hs-var">msg6</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Raj&quot;</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029682"><span class="annot"><span class="annottext">us7 :: User
</span><a href="#local-6989586621679029682"><span class="hs-identifier hs-var hs-var">us7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Raghunath&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029693"><span class="hs-identifier hs-var">msg7</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Raghunath&quot;</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029681"><span class="annot"><span class="annottext">us8 :: User
</span><a href="#local-6989586621679029681"><span class="hs-identifier hs-var hs-var">us8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Amitabh&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029692"><span class="hs-identifier hs-var">msg8</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Amitabh&quot;</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029680"><span class="annot"><span class="annottext">us9 :: User
</span><a href="#local-6989586621679029680"><span class="hs-identifier hs-var hs-var">us9</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Abhishek&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029691"><span class="hs-identifier hs-var">msg9</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Abhishek&quot;</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029679"><span class="annot"><span class="annottext">us10 :: User
</span><a href="#local-6989586621679029679"><span class="hs-identifier hs-var hs-var">us10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MVar Integer -&gt; String -&gt; User
</span><a href="Types.html#User"><span class="hs-identifier hs-var">User</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Shahid&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029690"><span class="hs-identifier hs-var">msg10</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is Shahid&quot;</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029678"><span class="annot"><span class="annottext">userlist :: [User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var hs-var">userlist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029689"><span class="hs-identifier hs-var">us1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029687"><span class="hs-identifier hs-var">us2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029686"><span class="hs-identifier hs-var">us3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029685"><span class="hs-identifier hs-var">us4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029684"><span class="hs-identifier hs-var">us5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029683"><span class="hs-identifier hs-var">us6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029682"><span class="hs-identifier hs-var">us7</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029681"><span class="hs-identifier hs-var">us8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029680"><span class="hs-identifier hs-var">us9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029679"><span class="hs-identifier hs-var">us10</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679029677"><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (MVar Integer)
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679029676"><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (MVar String)
forall a. IO (MVar a)
</span><span class="hs-identifier hs-var">newEmptyMVar</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-comment">--create threads for each user for concurrent use.sadasd</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029689"><span class="hs-identifier hs-var">us1</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029687"><span class="hs-identifier hs-var">us2</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029686"><span class="hs-identifier hs-var">us3</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029685"><span class="hs-identifier hs-var">us4</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029684"><span class="hs-identifier hs-var">us5</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029683"><span class="hs-identifier hs-var">us6</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029682"><span class="hs-identifier hs-var">us7</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029681"><span class="hs-identifier hs-var">us8</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029680"><span class="hs-identifier hs-var">us9</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
forall a.
(Ord a, Num a) =&gt;
MVar a -&gt; User -&gt; [User] -&gt; MVar String -&gt; IO ()
</span><a href="SendMessage.html#sendMessage"><span class="hs-identifier hs-var">sendMessage</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Integer
</span><a href="#local-6989586621679029677"><span class="hs-identifier hs-var">totalMessages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029679"><span class="hs-identifier hs-var">us10</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679029672"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679029672"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar String -&gt; IO String
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="annot"><span class="annottext">MVar String
</span><a href="#local-6989586621679029676"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A total of 100 messages has been sent across all the users.&quot;</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;---------------------------------------------------------&quot;</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">--userxcount is used for counting total number of messages received by the respective user.</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679029671"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029671"><span class="hs-identifier hs-var">user1count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">readMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029689"><span class="hs-identifier hs-var">us1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029689"><span class="hs-identifier hs-var">us1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029671"><span class="hs-identifier hs-var">user1count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679029667"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029667"><span class="hs-identifier hs-var">user2count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029687"><span class="hs-identifier hs-var">us2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029687"><span class="hs-identifier hs-var">us2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029667"><span class="hs-identifier hs-var">user2count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679029666"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029666"><span class="hs-identifier hs-var">user3count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029686"><span class="hs-identifier hs-var">us3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029686"><span class="hs-identifier hs-var">us3</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029666"><span class="hs-identifier hs-var">user3count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679029665"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029665"><span class="hs-identifier hs-var">user4count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029685"><span class="hs-identifier hs-var">us4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029685"><span class="hs-identifier hs-var">us4</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029665"><span class="hs-identifier hs-var">user4count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679029664"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029664"><span class="hs-identifier hs-var">user5count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029684"><span class="hs-identifier hs-var">us5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029684"><span class="hs-identifier hs-var">us5</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029664"><span class="hs-identifier hs-var">user5count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679029663"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029663"><span class="hs-identifier hs-var">user6count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029683"><span class="hs-identifier hs-var">us6</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029683"><span class="hs-identifier hs-var">us6</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029663"><span class="hs-identifier hs-var">user6count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679029662"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029662"><span class="hs-identifier hs-var">user7count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029682"><span class="hs-identifier hs-var">us7</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029682"><span class="hs-identifier hs-var">us7</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029662"><span class="hs-identifier hs-var">user7count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679029661"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029661"><span class="hs-identifier hs-var">user8count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029681"><span class="hs-identifier hs-var">us8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029681"><span class="hs-identifier hs-var">us8</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029661"><span class="hs-identifier hs-var">user8count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679029660"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029660"><span class="hs-identifier hs-var">user9count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029680"><span class="hs-identifier hs-var">us9</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029680"><span class="hs-identifier hs-var">us9</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029660"><span class="hs-identifier hs-var">user9count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>    </span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679029659"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029659"><span class="hs-identifier hs-var">user10count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar Integer -&gt; IO Integer
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">takeMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; MVar Integer
</span><a href="Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029679"><span class="hs-identifier hs-var">us10</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679029679"><span class="hs-identifier hs-var">us10</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029659"><span class="hs-identifier hs-var">user10count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; messages.&quot;</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">{-let tuser1count = round user1count :: Int
    --print $ tuser1count (integer)
    let tuser2count = round user2count :: Int
    --print $ tuser2count (integer)
    let tuser3count = round user3count :: Int
    --print $ tuser3count (integer)
    let tuser4count = round user4count :: Int
    --print $ tuser4count (integer)
    let tuser5count = round user5count :: Int
    --print $ tuser5count (integer)
    let tuser6count = round user6count :: Int
    --print $ tuser6count (integer)
    let tuser7count = round user7count :: Int
    --print $ tuser7count (integer)
    let tuser8count = round user8count :: Int
    --print $ tuser8count (integer)
    let tuser9count = round user9count :: Int
    --print $ tuser9count (integer)
    let tuser10count = round user10count :: Int
    --print $ tuser10count (integer) -}</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029658"><span class="annot"><span class="annottext">usercountfinal :: [Integer]
</span><a href="#local-6989586621679029658"><span class="hs-identifier hs-var hs-var">usercountfinal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029671"><span class="hs-identifier hs-var">user1count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029667"><span class="hs-identifier hs-var">user2count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029666"><span class="hs-identifier hs-var">user3count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029665"><span class="hs-identifier hs-var">user4count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029664"><span class="hs-identifier hs-var">user5count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029663"><span class="hs-identifier hs-var">user6count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029662"><span class="hs-identifier hs-var">user7count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029661"><span class="hs-identifier hs-var">user8count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029660"><span class="hs-identifier hs-var">user9count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029659"><span class="hs-identifier hs-var">user10count</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">--we just converted type(double) to type(int) and put them all in a list -&gt; usercountfinal</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">{-
    $ &quot;:::: TRYING TO PRINT IN INTEGER FORMAT ::::&quot;
    print $ usercountfinal
    print $ &quot; --&gt; &quot; ++ name us1 ++ &quot; has received &quot; ++ show (tuser1count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us2 ++ &quot; has received &quot; ++ show (tuser2count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us3 ++ &quot; has received &quot; ++ show (tuser3count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us4 ++ &quot; has received &quot; ++ show (tuser4count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us5 ++ &quot; has received &quot; ++ show (tuser5count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us6 ++ &quot; has received &quot; ++ show (tuser6count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us7 ++ &quot; has received &quot; ++ show (tuser7count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us8 ++ &quot; has received &quot; ++ show (tuser8count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us9 ++ &quot; has received &quot; ++ show (tuser9count) ++ &quot; messages.&quot;
    print $ &quot; --&gt; &quot; ++ name us10 ++ &quot; has received &quot; ++ show (tuser10count) ++ &quot; messages.&quot; 
    -}</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029657"><span class="annot"><span class="annottext">y :: Integer
</span><a href="#local-6989586621679029657"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679029658"><span class="hs-identifier hs-var">usercountfinal</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; [Integer] -&gt; [User] -&gt; IO ()
forall a. (Show a, Eq a) =&gt; a -&gt; [a] -&gt; [User] -&gt; IO ()
</span><a href="Main.html#tre"><span class="hs-identifier hs-var">tre</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679029657"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679029658"><span class="hs-identifier hs-var">usercountfinal</span></a></span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029678"><span class="hs-identifier hs-var">userlist</span></a></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | To find user details of the user who has received the most number of messages.</span><span>
</span><span id="line-122"></span><span id="tre"><span class="annot"><span class="annottext">tre :: a -&gt; [a] -&gt; [User] -&gt; IO ()
</span><a href="Main.html#tre"><span class="hs-identifier hs-var hs-var">tre</span></a></span></span><span> </span><span id="local-6989586621679029654"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679029654"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679029653"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679029653"><span class="hs-identifier hs-var">usercountfinal</span></a></span></span><span> </span><span id="local-6989586621679029652"><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029652"><span class="hs-identifier hs-var">userlist</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679029651"><span class="annot"><span class="annottext">u :: Int
</span><a href="#local-6989586621679029651"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679029654"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679029653"><span class="hs-identifier hs-var">usercountfinal</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679029652"><span class="hs-identifier hs-var">userlist</span></a></span><span> </span><span class="annot"><span class="annottext">[User] -&gt; Int -&gt; User
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679029651"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has received the most number of messages (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679029654"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;).&quot;</span></span></pre></body></html>